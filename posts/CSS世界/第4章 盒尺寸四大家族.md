# 第4章 盒尺寸四大家族 #

# 深入理解`content` #

## `content`与替换元素 ##

**1. 什么是替换元素**

通过修改某个属性值呈现的内容就可以被替换的元素称为**替换元素**。因此，`img`、`object`、`video`、`iframe`或者表单元素`textarea`和`input`都是典型的替换元素。

替换元素除了内容可替换这一特性外，还有一些特性：

1. **内容的外观不受页面上的CSS的影响**。样式表现在CSS作用域之外。更改替换元素自身的外观需要浏览器自身暴露的一些样式接口。
2. **有自己的尺寸**。替换元素在没有明确尺寸设定的情况下，其默认的尺寸（不包括边框）是`300px*150px`。
3. **在很多CSS属性上有自己的一套表现规则。**比较具有代表性的就是`vertical-align`属性。对于非替换元素，`vertical-align`的默认值是`baseline`，被定义为字符`x`的下边缘；对于替换元素的内容没有字符`x`，替换元素的基线就被定义为元素的下边缘。

**2. 替换元素的默认`display`值**

所有的替换元素都是内联元素，也就是替换元素和替换元素、替换元素和文字都是可以在一行显示的。

> 各个替换元素的默认`display`属性值（P46）

**`input`和`button`按钮的区别在什么地方？**区别在于两种按钮默认的`white-space`值不一样，前者是`pre`，后者是`normal`，所表现出来的差异是：**当按钮文字足够多时，`input`按钮不会自动换行，`button`按钮则会。**

> 替换元素的`display`是`inline`、`block`和`inline-block`中的任意一个，其尺寸计算规则都是一样的。

**3. 替换元素的尺寸计算规则**

替换元素的尺寸从内到外分为3类：固有尺寸、HTML尺寸和CSS尺寸。

1. 固有尺寸指的是替换内容原本的尺寸。
2. HTML尺寸`img`、`input`只能通过HTML原生属性改变。
3. CSS尺寸指的是可以通过CSS的`width`和`height`或者`max-width/min-width`和`max-height/min-width`设置的尺寸，对应盒尺寸的`content box`。

> 可以影响替换元素的3层结构（由里到外）：固有尺寸->HTML尺寸->CSS尺寸

这3层结构的计算规则：

- 如果没有CSS尺寸和HTML尺寸，使用固有尺寸作为最终的宽高。


    <img src="1.jpg" alt="">

页面显示宽高就是图片自身的尺寸`256px*192px`。

- 如果没有CSS尺寸，则使用HTML尺寸作为最终的宽高。


    <img src="1.jpg" width="128" height="128" alt="">
    
通过HTML属性`width`和`height`限定了图片的HTML尺寸，因此最终图片所呈现的宽高就是`128px*128px`。

- 如果有CSS尺寸，则最终尺寸由CSS属性决定。


    img {
        width: 200px;
        height: 150px;
    }
    <img src="1.jpg" width="128" height="128" alt="">
    
此时，固有尺寸、CSS尺寸和HTML尺寸同时存在，起作用的是CSS属性限定的尺寸，因此，最终图片所呈现的宽高就是`200px*150px`。

- 如果固有尺寸含有固有的宽高比例，同时仅设置了宽度或高度，则元素依然按照固有的宽高比例显示。


    img {
        width: 200px;
    }
    <img src="1.jpg" alt="">
    
设置的宽度，因为图片自身有着固定的宽高比例，所以最终图片呈现的宽高就是`200px*150px`（`150=200+192/256`）    

- 如果条件不符合，在所有现代浏览器下的尺寸表现都是`300px*150px`。
- 内联替换元素和块级替换元素使用上面同一套尺寸计算规则。

> 实际开发中，为了提高加载性能和节约带宽费用，首屏图片采用滚屏的方式异步加载，并且使用一张透明的图片占位。一般直接使用`<img>`。

    img {
        visibility: hidden;
    }
    
    img[src] {
        visibility: visible;
    }

当`img`标签中有`src`属性时，即使为空，浏览器依然会发起请求，而且请求的是当前页面数据。当图片的`src`缺省时，图片不会有任何请求，是最高效的实现方式。

Firefox下`img`的表现是一个内联元素，而非替换元素，因此很多设置都它下面无效。要修复这个问题非常简单，就是直接设置`img {display:inline-block;}`

> 在CSS中，图片的固有尺寸是无法改变的，显示的仅仅是设定的`content box`尺寸，图片中的`content`替换内容默认的适配方式是填充`fill`。
> 尺寸变化的本质并不是改变固有尺寸，而是采用了填充作为适配HTML尺寸和CSS尺寸的方式。
> 在CSS3中，`img`以及其它替换元素的适配方式可以通过`object-fit`属性进行修改。

**4. **





